{% extends 'base.html.twig' %}

{% block title %}Accueil - AquaBiome{% endblock %}
{% block page_name %}Accueil{% endblock %}
{% block page_icon %}ğŸ {% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/home.css') }}">
    <style>
        /* Petit ajout CSS pour les cartes de graphiques */
        .chart-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        .chart-card h3 {
            margin-top: 0;
            color: #333;
            font-size: 1.1rem;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
    </style>
{% endblock %}

{% block body %}
<div class="home-content">
    
   {# Header de bienvenue #}
    <section class="user-welcome">
        <div class="welcome-avatar">ğŸ‘¤</div>
        <p>
            Bienvenue Ã  toi, 
            <strong>{{ app.user ? app.user.userIdentifier : 'InvitÃ©' }}</strong>
        </p>
    </section>

    {# Section Alertes #}
    <section class="alerts-section">
        <div class="alert-card">
            <h3>Alerte(s) & Notifications</h3>
            <div style="height: 40px;">
                {% if mesure is null %}
                    <p style="font-size: 0.8rem; color: #666;">Aucune donnÃ©e enregistrÃ©e pour le moment.</p>
                {% else %}
                    <p style="font-size: 0.8rem; color: #27ae60;">DerniÃ¨re mise Ã  jour : {{ mesure.dateSaisie|date('d/m/Y H:i') }}</p>
                {% endif %}
            </div>
        </div>
    </section>

    {# Grille des paramÃ¨tres dynamiques #}
    <section class="stats-grid">
        {# Carte TempÃ©rature #}
        <div class="stat-card">
            <span class="status-badge">Normal</span>
            <div class="stat-icon" style="color: #ff7675;">Â°C</div>
            <span class="stat-label">TempÃ©rature</span>
            <div class="stat-value">
                {{ (mesure and mesure.temperature is not null) ? mesure.temperature : '--' }}Â°C
            </div>
            <span class="stat-range">Plage: 22-26Â°C</span>
        </div>

        {# Carte pH #}
        <div class="stat-card">
            <span class="status-badge">Normal</span>
            <div class="stat-icon" style="color: #74b9ff;">ğŸ§ª</div>
            <span class="stat-label">pH</span>
            <div class="stat-value">
                {{ (mesure and mesure.ph is not null) ? mesure.ph : '--' }}
            </div>
            <span class="stat-range">Plage: 6.5-7.5</span>
        </div>

        {# Carte GH (Pleine largeur) #}
        <div class="stat-card full-width">
            <span class="status-badge">Normal</span>
            <div class="stat-icon" style="color: #00cec9;">ğŸ’§</div>
            <span class="stat-label">GH (DuretÃ© totale)</span>
            <div class="stat-value">
                {{ (mesure and mesure.gh is not null) ? mesure.gh : '--' }} Â°dH
            </div>
            <span class="stat-range">Plage: 6-12 Â°dH</span>
        </div>
    </section>
<<<<<<< Updated upstream
</div>
=======

    {# Section des Graphiques D3.js #}
    <section class="charts-section" style="padding-top: 30px; display: flex; flex-direction: column; gap: 30px;">
        <div class="chart-card">
            <h3>ğŸ“ˆ Suivi GH (DuretÃ© totale)</h3>
            <div id="chart_gh"></div>
        </div>

        <div class="chart-card">
            <h3>ğŸ§ª Ã‰quilibre pH & KH</h3>
            <div id="chart_ph_kh"></div>
        </div>

        <div class="chart-card">
            <h3>âš ï¸ Ã‰lÃ©ments Toxiques (Nitrites / Ammonium)</h3>
            <div id="chart_toxic"></div>
        </div>
    </section>
</div>

{# Scripts D3.js #}
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
    // RÃ©cupÃ©ration des donnÃ©es du contrÃ´leur
    const rawData = {{ chartData|raw }};
    console.log("DonnÃ©es pour D3.js :", rawData);
</script>
<script src="{{ asset('js/aquarium_charts.js') }}"></script>

>>>>>>> Stashed changes
{% endblock %}